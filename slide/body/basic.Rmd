## 今日の趣旨

1. gitを覚える (頭で)
1. 呪文を覚える (身体で)
1. 呪文を打ち消す呪文を覚える (身体で)

2と3をひたすら繰り返す.




<div style="font-size:xx-small;">

>	重犯罪人に自分の罪を思い知らせるなら、土を掘り移動させ、それからまた埋めて元に戻す、という作業を延々と繰り返させればよい。それは究極の拷問であり、最後には精神に異常をきたすであろう。(ドフトエフスキー?)

</div>

## 今日扱うcommandたち

<div class="container">
<div class="left">

##### 1つのbranchの操作
gitを使ったbackupの取り方

- git status
- git init
- git add 
- git commit 
- git reset 
- git rm
- git mv
- git commit --amend
- git rebase -i


</div>
<div class="contents">

##### 複数のbranchの操作
複数のversionに分岐する場合を扱う<br>(e.g., 研究会の原稿から国際会議と<br>修論の原稿に分岐)

- git log
- git branch
- git checkout
- git merge
- git rebase

</div>
<div class="right">

##### remote branchの操作
Cloudを利用して<br>ユビキタス(死語)に使う.

- git clone
- git fetch
- git pull
- git push

</div>
</div>

## Gitってなんだよ

プログラムのソースコードなどの変更履歴を記録・追跡するための分散型バージョン管理システムだよ.

## 作った人 

<div class="column-left">
<div align="center">
<img src="https://media.giphy.com/media/xndHaRIcvge5y/giphy.gif" width="450px">
</div>
</div>

<div class="column-right">
**リーナス・トーバルズ**

- Linux作った人(GitはLinux開発のためのツールとして作ったらしい)
- Linuxは修論で作ったらしい
- Gitは2週間くらいで作ったらしい 
- 開発当時,有名なOSの教授とお互いのOSを貶し合ってめちゃくちゃ喧嘩したのが伝説になっている
- 今はContributerに暴言を吐きまくりながらLinux Kernelの開発を続けている
- 最近,人の気持を学んでくるとか言って自主謹慎した
- 優しい終身の独裁者(OSSコミュニティのリーダをこう呼ぶ)の一人
- 優しい...
</div>

## なにができんだよ

fileの変更履歴を保存しておいて,あとから好きな時点の状態に復元できるよ.

---

### Google driveでよくね? 

よくない.

**Google driveでできないこと**

- RemoteとSyncするタイミングを制御できない(変更した瞬間*自動的*にSync)
    - 複数人で同じdirectoryの中身を編集できない
- directoryのバックアップに含めるfileを制御できない(*自動的*にバックアップ対象に追加される)
    - 設定ファイルはPCごとに別にしたいのでSyncしたくないとか思ってもできない 

この2つの欠点のせいで,シミュレータが動く状態のdirectoryに戻したいとかいうことができない.

自動的(Automatic)はユーザから選択の自由を奪っている.

オートマ => 人権侵害

---

- これらができないがためにこうなりがち

<div align="center">
<img src="./fig/backup_hell.png" width="650px">
</div>


## 頭で覚えること 

Gitには3つの視点がある

- Commit tree 
- Three areas 
- File status 

これらを理解すればGit master.

## Commit tree 

Commit (directoryのスナップショット)からなるツリー(一番重要).

- たくさんのスナップショット(バックアップ)を効率的に管理する方法と考えれば良い.
- CommitはdirectoryのスナップショットにIDとしてhash値を振ったもの.
- Commitには親となるCommitが記録されている (= ツリー構造)
- Hash値だけで管理すると人間が覚えられなくなってしまうのでHEADとかmasterみたいなタグを使う
- master, HEAD, branchなどは特定のCommitを指しているTag (Pointer)の名前(**重要**)
- 1度作ったcommitは基本的になくならない(探せなくはなるので注意) 

<div align="center">
<img src="https://git-scm.com/book/en/v2/images/advance-master.png" width="450px">
</div>


--- 

### タグのイメージ

<div align="center">
<img src="https://pbs.twimg.com/media/CpvqRmiUAAAPlLm.jpg" width="650px">
</div>

- 最後尾のCommit(人)は新しい人が並ぶたびに変わるが,最後尾は常に札の指す先にある.

---

### どういうときに思い出すべき?

- branchの操作 (branch, checkout, reset, rebase, push, pull)
- commitの操作 (reset, cherry-pick)

## Three areas 

1つのCommitの裏には3つのレイヤがある

1. Working directory: 実際のdirectory
1. Staging Area (Index): Working direcoryのファイルのうちCommitに含まれる予定のファイルのcopy
1. git directory: Staging areaのfileがcopyされて来てスナップショットになる

<div align="center">
<img src="https://git-scm.com/book/en/v2/images/areas.png" width="450px">
</div>

---

もう少しわかりやすく

- Working directory: 
    - 実際のDirectory
- Staging Area (Index): 
    - これからBackupしたいファイルを一時的にCopyしておくところ 
- git directory: 
    - Backupを取るコマンドが実行されるとここに新しいDirectoryができてStaging areaのファイルがまるごと保存される.
    - ここにはこれまでのBackup direcotryが全部おいてある(Directorynの名前にはHashが自動的に振られる)

--- 

### どういうときに思い出すべき?

- 特定のCommitの変更 (reset, checkout)
- 特定のfileの操作 (add, rm, mv, reset, stash)

## File status 

fileには4つの状態がある(three areasと合わせて覚えると良い)

1. Untracked: gitの追跡対象外のfile
1. Unmodified: gitの追跡対象で変更されていないfile(=Commitのfileと同じ)
1. Modified: gitの追跡対象で変更されたfile(=Commitのfileと違う)
1. Staged: gitの追跡対象で変更されたfileでStaging areaにcopy済みのもの 

<div align="center">
<img src="https://git-scm.com/book/en/v2/images/lifecycle.png" width="450px">
</div>


--- 

### どういうときに思い出すべき?

- 特定のfileの操作 (add, rm, mv, reset, stash)

## おめでとう 

あなたは,gitマスターになりました.

